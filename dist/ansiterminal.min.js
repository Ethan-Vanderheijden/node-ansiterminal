!function(){"use strict";function s(s,r,t,e){this.c=s,this.attr=0|r,this.gb=0|t,this.width=void 0===e?1:e}function r(s){return s.replace(/[\x00]+$/,"")}function t(r,t){this.uniqueId=0|u++,this.version=1,this.cells=[];for(var e=0;r>e;++e)this.cells.push(new s(t.c,t.attr,t.gb,t.width))}function e(s,r,t,e){if(!r)return"[0m";var o=r>>>16&255,i=s>>>16&255^o,c=r>>>24,h=65535&r,n=[];return i&&(1&i&&n.push(1&o?1:22),2&i&&n.push(2&o?3:23),4&i&&n.push(4&o?4:24),8&i&&n.push(8&o?5:25),16&i&&n.push(16&o?7:27),32&i&&n.push(32&o?8:28)),(s>>>24^c||65535&s^h||t^e)&&(4&c?8&c?n.push(38,2,h>>>8,e>>>24,(65535&e)>>>8):n.push(38,5,1&o?h>>>8|8:h>>>8):67108864&s&&n.push(39),1&c?2&c?n.push(48,2,255&h,e>>>16&255,255&e):n.push(48,5,255&h):16777216&s&&n.push(49)),"["+n.join(";")+"m"}function o(s){if("foreground"==s)return"#ffffff";if("background"==s)return"#000000";if(16>s)return a[s];if(232>s){var r=[0,95,135,175,215,255];s-=16;for(var t=0,e=0;3>e;++e)t+=r[s%6]<<8*e,s=parseInt(s/6);return t=t.toString(16),"#"+Array(6-t.length+1).join("0")+t}var o=8+10*(s-232);return"#"+(o+(o<<8)+(o<<16)).toString(16)}function i(s,r){var t="",e="";if(r.classes?(s.bold&&(e+="bold "),s.italic&&(e+="italic "),s.underline&&(e+="underline "),s.blink&&(e+="blink "),s.conceal&&(e+="conceal ")):(s.bold&&(t+="font-weight:bold;"),s.italic&&(t+="font-style:italic;"),s.underline&&(t+="font-decoration:underline;"),s.blink&&(t+="visibility:hidden;animation: "+r.blinkanimation+" 1s steps(1, start) infinite;"),s.conceal&&(t+="visibility:hidden;")),s.inverse){var o=s.foreground;s.foreground=s.background,s.background=o}if(s.foreground)if("RGB"==s.foreground.mode)t+="color:rgb(",t+=s.foreground.color.r,t+=",",t+=s.foreground.color.g,t+=",",t+=s.foreground.color.b,t+=");";else{var i=s.foreground.color;s.bold&&(i=8|i),r.classes?e+="fg"+i+" ":t+="color:"+r.colors(i)+";"}else s.inverse&&(r.classes?e+="fg-1 ":t+="color:"+r.colors("background")+";");return s.background?"RGB"==s.background.mode?(t+="background-color:rgb(",t+=s.background.color.r,t+=",",t+=s.background.color.g,t+=",",t+=s.background.color.b,t+=");"):r.classes?e+="bg"+s.background.color+" ":t+="background-color:"+r.colors(s.background.color)+";":s.inverse&&(r.classes?e+="bg-1 ":t+="background-color:"+r.colors("foreground")+";"),e&&(e=' class="'+e.trim()+'"'),t&&(t=' style="'+t.trim()+'"'),e+t}function c(s){return s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function h(s,r,t){this.rows=r,this.cols=s,this.scrollLength=0|t,this.buffer=[],this.scrollbuffer=[],this.reset()}function n(s,r,t){this.rows=r,this.cols=s,this.scrollLength=0|t,this.send=function(s){},this.beep=function(s,r){},this.changedMouseHandling=function(s,r){},this.reset()}var l=function(){function s(s){var r,t=0,o=e.length-1;if(s<e[0][0]||s>e[o][1])return!1;for(;o>=t;)if(r=Math.floor((t+o)/2),s>e[r][1])t=r+1;else{if(!(s<e[r][0]))return!0;o=r-1}return!1}function r(r,t){return 0===r?t.nul:32>r||r>=127&&160>r?t.control:s(r)?0:1+(r>=4352&&(4447>=r||9001==r||9002==r||r>=11904&&42191>=r&&12351!=r||r>=44032&&55203>=r||r>=63744&&64255>=r||r>=65040&&65049>=r||r>=65072&&65135>=r||r>=65280&&65376>=r||r>=65504&&65510>=r||r>=131072&&196605>=r||r>=196608&&262141>=r))}function t(s,t){if(t=o,"string"!=typeof s)return r(s,t);for(var e=0,i=0;i<s.length;i++){var c=r(s.charCodeAt(i),t);if(0>c)return-1;e+=c}return e}var e=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531],[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],o={nul:0,control:0};return t}();s.prototype.clone=function(){return new s(this.c,this.attr,this.gb,this.width)},s.prototype.equals=function(r){return r instanceof s&&this.c==r.c&&this.attr==r.attr&&this.gb==r.gb&&this.width==r.width},s.prototype.serialize=function(){return[this.c,this.attr,this.gb,this.width]},s.deserialize=function(r){return new s(r[0],r[1],r[2],r[3])},s.prototype.getAttributes=function(){var s=this.attr>>>24,r=65535&this.attr,t=this.gb>>>16,e=65535&this.gb,o=this.attr>>>16&255;return{bold:!!(1&o),italic:!!(2&o),underline:!!(4&o),blink:!!(8&o),inverse:!!(16&o),conceal:!!(32&o),foreground:{set:!!(4&s),RGB:!!(8&s),color:[r>>>8,t>>>8,e>>>8]},background:{set:!!(1&s),RGB:!!(2&s),color:[255&r,255&t,255&e]}}},s.prototype.getJSONAttributes=function(){var s=this.attr>>>24,r=65535&this.attr,t=this.gb>>>16,e=65535&this.gb,o=this.attr>>>16&255,i={bold:!!(1&o),italic:!!(2&o),underline:!!(4&o),blink:!!(8&o),inverse:!!(16&o),conceal:!!(32&o),foreground:!1,background:!1};return 4&s&&(i.foreground={},8&s?(i.foreground.mode="RGB",i.foreground.color={r:r>>>8,g:t>>>8,b:e>>>8}):(i.foreground.mode="256",i.foreground.color=r>>>8)),1&s&&(i.background={},2&s?(i.background.mode="RGB",i.background.color={r:255&r,g:255&t,b:255&e}):(i.background.mode="256",i.background.color=255&r)),i},s.prototype.setAttributes=function(s){if(0===s)return this.attr=0,void(this.gb=0);var r=this.attr;if(["bold","italic","underline","blink","inverse","conceal"].map(function(t,e){void 0!==s[t]&&(r=s[t]?r|2<<15+e:r&~(2<<15+e))}),s.foreground){var t=s.foreground;void 0!==t.set&&(r=t.set?r|2<<25:r&~(2<<25)),void 0!==t.RGB&&(r=t.RGB?r|2<<26:r&~(2<<26)),void 0!==t.color&&(r=-65281&r|t.color[0]<<8,this.gb=16777215&this.gb|t.color[1]<<24,this.gb=-65281&this.gb|t.color[2]<<8)}if(s.background){var e=s.background;void 0!==e.set&&(r=e.set?r|2<<23:r&~(2<<23)),void 0!==e.RGB&&(r=e.RGB?r|2<<24:r&~(2<<24)),void 0!==e.color&&(r=-256&r|e.color[0],this.gb=-16711681&this.gb|e.color[1]<<16,this.gb=-256&this.gb|e.color[2])}this.attr=r};var u=0;t.prototype.serialize=function(){for(var s=[],r=0;r<this.cells.length;++r)s.push(this.cells[r].serialize());return s},t.deserialize=function(r){for(var e=new t(0,null),o=0;o<r.length;++o)e.cells.push(s.deserialize(r[o]));return e},t.prototype.toString=function(s){var t={rtrim:!0,empty_cell:" "};s&&(s.hasOwnProperty("rtrim")&&(t.rtrim=s.rtrim),s.hasOwnProperty("empty_cell")&&(t.empty_cell=s.empty_cell));for(var e="",o=0;o<this.cells.length;++o)e+=this.cells[o].c||"\x00";return t.rtrim&&(e=r(e)),e.replace(/\x00/g,t.empty_cell)},t.prototype.toMergedArray=function(s){var t={rtrim:!1,empty_cell:"Â "};s&&(s.hasOwnProperty("rtrim")&&(t.rtrim=s.rtrim),s.hasOwnProperty("empty_cell")&&(t.empty_cell=s.empty_cell));var e=[];if(!this.cells.length)return e;var o=null,i=this.cells[0].clone();i.c=i.c||"\x00";for(var c=1;c<this.cells.length;++c)o=this.cells[c],i.attr!==o.attr?(e.push(i),i=o.clone(),i.c=i.c||"\x00"):o.width&&(i.c+=o.c||"\x00",i.width+=o.width);if(e.push(i),t.rtrim)for(;e.length;){var h=e.pop(),n=r(h.c);if(n.length){h.width-=h.c.length-n.length,h.c=n,e.push(h);break}}for(c=0;c<e.length;++c)e[c].c=e[c].c.replace(/\x00/g,t.empty_cell);return e},t.prototype.toJSON=function(s){for(var r=[],t=this.toMergedArray(s),e=null,o=0;o<t.length;++o)e=t[o],r.push({string:e.c,width:e.width,attributes:e.getJSONAttributes()});return r},t.prototype.toEscapeString=function(s){for(var r="[0m",t=this.toMergedArray(s),o=null,i=0,c=0,h=0;h<t.length;++h)o=t[h],r+=e(i,o.attr,c,o.gb),r+=o.c,i=o.attr,c=o.gb;return i&&(r+="[0m"),r};var a=["#000000","#cd0000","#00cd00","#cdcd00","#0000ee","#cd00cd","#00cdcd","#e5e5e5","#7f7f7f","#ff0000","#00ff00","#ffff00","#5c5cff","#ff00ff","#00ffff","#ffffff"];t.prototype.toHTML=function(s){var r={rtrim:!0,empty_cell:"Â ",blinkanimation:"blink",classes:!0,colors:o,escape_html:!0};if(s)for(var t=["rtrim","empty_cell","blinkanimation","colors","classes"],e=0;e<t.length;++e)s.hasOwnProperty(t[e])&&(r[t[e]]=s[t[e]]);for(var h=this.toMergedArray(r),n="",l=null,u=0;u<h.length;++u)l=h[u],l.attr&&(n+="<span"+i(l.getJSONAttributes(),r)+">"),n+=r.escape_html?c(l.c):l.c,l.attr&&(n+="</span>");return n},h.prototype.reset=function(){this.buffer=[],this.scrollbuffer=[];for(var r,e=0;e<this.rows;++e)r=new t(this.cols,new s("")),this.buffer.push(r)},h.prototype.serialize=function(){var s,r=[],t=[];for(s=0;s<this.buffer.length;++s)r.push(this.buffer[s].serialize());for(s=0;s<this.scrollbuffer.length;++s)t.push(this.scrollbuffer[s].serialize());return{cols:this.cols,rows:this.rows,scrollLength:this.scrollLength,buffer:r,scrollbuffer:t}},h.deserialize=function(s){var r,e=new h(0,0,0);for(e.rows=s.rows,e.cols=s.cols,e.scrollLength=s.scrollLength,r=0;r<e.rows;++r)e.buffer.push(t.deserialize(s.buffer[r]));for(r=0;r<e.scrollLength;++r)e.scrollbuffer.push(t.deserialize(s.scrollbuffer[r]));return e},h.prototype.appendToScrollBuffer=function(s){for(this.scrollbuffer.push(s);this.scrollbuffer.length>this.scrollLength;)this.scrollbuffer.shift()},h.prototype.fetchFromScrollBuffer=function(){return this.scrollbuffer.pop()},h.prototype.resize=function(r,e,o){if(e<this.rows)for(;this.buffer.length>e;)this.buffer.length>o.row+1?this.buffer.pop():(this.appendToScrollBuffer(this.buffer.shift()),o.row-=1);if(e>this.rows)for(;this.buffer.length<e;){var i=this.fetchFromScrollBuffer();i?(this.buffer.unshift(i),o.row+=1):(i=new t(this.cols,new s("")),this.buffer.push(i))}o.row>=e&&(o.row=e-1);var c;if(r<this.cols){for(c=0;c<this.buffer.length;++c){var h=this.cols-r;do this.buffer[c].cells.pop();while(--h);this.buffer[c].version++}for(c=0;c<this.scrollbuffer.length;++c){h=this.cols-r;do this.scrollbuffer[c].cells.pop();while(--h);this.scrollbuffer[c].version++}}if(r>this.cols){for(c=0;c<this.buffer.length;++c){var n=r-this.cols;do this.buffer[c].cells.push(new s(""));while(--n);this.buffer[c].version++}for(c=0;c<this.scrollbuffer.length;++c){n=r-this.cols;do this.scrollbuffer[c].cells.push(new s(""));while(--n);this.scrollbuffer[c].version++}}o.col>=r&&(o.col=r-1),this.rows=e,this.cols=r};var f={"`":"â",a:"â",b:"â",c:"â",d:"â",e:"â",f:"Â°",g:"Â±",h:"â¤",i:"â",j:"â",k:"â",l:"â",m:"â",n:"â¼",o:"âº",p:"â»",q:"â",r:"â¼",s:"â½",t:"â",u:"â¤",v:"â´",w:"â¬",x:"â",y:"â¤",z:"â¥","{":"Ï","|":"â ","}":"Â£","~":"Â°"},b={"â":"â","â":"â","â":"â","â":"â","â":"â","â":"â","â":"â","â":"â","â":"â","â":"â","â":"â£","â¤":"â«","â¬":"â³","â´":"â»","â¼":"â","â":"â","â":"â"},p={CSI:"[",SS3:"O",DCS:"P",ST:"\\",OSC:"]",PM:"^",APC:"_"};n.prototype.reset=function(){this.normal_screen=new h(this.cols,this.rows,this.scrollLength),this.alternate_screen=new h(this.cols,this.rows,0),this.screen=this.normal_screen,this.normal_cursor={col:0,row:0},this.alternate_cursor={col:0,row:0},this.cursor=this.normal_cursor,this.charset=null,this.textattributes=0,this.colors=0,this.charattributes=0,this.reverse_video=!1,this.cursor_key_mode=!1,this.show_cursor=!0,this.title="",this.cursor_save=null,this.insert_mode=!1,this.blinking_cursor=!1,this.scrolling_top=0,this.scrolling_bottom=this.rows,this.autowrap=!0,this.newline_mode=!1,this.tab_width=8,this.last_char="",this.mouse_mode=0,this.mouse_protocol=0,this.mouseDown={1:!1,2:!1,3:!1,4:!1},this._rem_c="",this.wrap=!1,this.row_wrap=!1},n.prototype.toString=function(s){for(var r="",t=0;t<this.screen.buffer.length;++t)r+=this.screen.buffer[t].toString(s),r+="\n";return r},n.prototype.resize=function(s,r){return 2>s||2>r?!1:(this.normal_screen.resize(s,r,this.normal_cursor),this.alternate_screen.resize(s,r,this.alternate_cursor),this.rows=r,this.cols=s,this.scrolling_top=0,this.scrolling_bottom=this.rows,void(this.cursor_save&&this.DECSC()))},n.prototype.inst_p=function(r){this.debug&&console.log("inst_p",r);var t="",e=0,o=0,i=1;this._rem_c&&(r=this._rem_c+r,this._rem_c="");for(var c=0;c<r.length;++c){if(t=r.charAt(c),e=r.charCodeAt(c),e>=55296&&56319>=e){if(o=r.charCodeAt(c+1),o!==o)return void(this._rem_c=t);e=1024*(e-55296)+(o-56320)+65536,t+=r.charAt(c+1)}if(!(e>=56320&&57343>=e)){if(i=l(e),2==i&&i+this.cursor.col>this.cols){if(!this.autowrap)continue;this.wrap=!0}if(this.wrap&&i&&(this.cursor.col=0,this.cursor.row++,this.wrap=!1),this.cursor.row>=this.scrolling_bottom&&(this.SU(),this.cursor.row--),this.screen.buffer[this.cursor.row].version++,!i&&this.cursor.col)this.wrap?this.screen.buffer[this.cursor.row].cells[this.cursor.col].c+=t:0==this.screen.buffer[this.cursor.row].cells[this.cursor.col-1].width?this.cursor.col-2>=0&&2==this.screen.buffer[this.cursor.row].cells[this.cursor.col-2].width&&(this.screen.buffer[this.cursor.row].cells[this.cursor.col-2].c+=t):this.screen.buffer[this.cursor.row].cells[this.cursor.col-1].c+=t;else{if(t=this.charset?this.charset[t]||t:t,this.last_char=t,this.insert_mode&&(this.screen.buffer[this.cursor.row].cells.pop(),this.screen.buffer[this.cursor.row].cells.splice(this.cursor.col,0,new s("",this.textattributes,this.colors))),this.screen.buffer[this.cursor.row].cells[this.cursor.col].c=t,this.screen.buffer[this.cursor.row].cells[this.cursor.col].attr=this.charattributes,this.screen.buffer[this.cursor.row].cells[this.cursor.col].gb=this.colors,this.screen.buffer[this.cursor.row].cells[this.cursor.col].width=i,t>="â"&&"â">=t&&this.textattributes&&65536&this.textattributes){this.screen.buffer[this.cursor.row].cells[this.cursor.col].c=b[t]||t;var h=-65537&this.charattributes;67108864&h&&!(134217728&h)&&8>(h>>>8&255)&&(h|=2048),this.screen.buffer[this.cursor.row].cells[this.cursor.col].attr=h}this.cursor.col+=1}2==i&&(this.insert_mode&&(this.screen.buffer[this.cursor.row].cells.pop(),this.screen.buffer[this.cursor.row].cells.splice(this.cursor.col,0,new s("",this.textattributes,this.colors)),2==this.screen.buffer[this.cursor.row].cells[this.cols-1].width&&(this.screen.buffer[this.cursor.row].cells.pop(),this.screen.buffer[this.cursor.row].cells.push(new s("",this.textattributes,this.colors)))),this.screen.buffer[this.cursor.row].cells[this.cursor.col].width=0,this.screen.buffer[this.cursor.row].cells[this.cursor.col].c="",this.screen.buffer[this.cursor.row].cells[this.cursor.col].attr=this.charattributes,this.screen.buffer[this.cursor.row].cells[this.cursor.col].gb=this.colors,this.cursor.col+=1,this.cursor.col>=this.cols&&(this.cursor.col=this.cols-2,this.autowrap&&(this.wrap=!0))),this.cursor.col>=this.cols&&(this.cursor.col=this.cols-1,this.autowrap&&(this.wrap=!0))}}},n.prototype.inst_o=function(s){this.debug&&console.log("inst_o",s),this.last_char="",this._rem_c="",this.wrap=!1,"0"==s.charAt(0)?this.title=s.slice(2):console.log("inst_o unhandled:",s)},n.prototype.inst_x=function(s){switch(this.debug&&console.log("inst_x",s.charCodeAt(0),s),this.last_char="",this._rem_c="",this.wrap=!1,s){case"\n":this.cursor.row++,this.cursor.row>=this.scrolling_bottom&&(this.SU(),this.cursor.row--),this.newline_mode&&(this.cursor.col=0),this.cursor.col>=this.cols&&this.cursor.col--;break;case"\r":this.cursor.col=0;break;case"	":this.CHT([0]);break;case"":this.beep();break;case"\b":this.cursor.col>=this.cols&&(this.cursor.col=this.cols-1),this.cursor.col-=1,this.cursor.col<0&&(this.cursor.col=0);break;case"\x0B":this.inst_x("\n");break;case"\f":this.inst_x("\n");break;case"":this.charset=f;break;case"":this.charset=null;break;case"":console.log("unhandled DC1 (XON)");break;case"":break;case"":console.log("unhandled DC3 (XOFF)");break;case"":break;default:console.log("inst_x unhandled:",s.charCodeAt(0))}},n.prototype.inst_c=function(s,r,t){switch(this.debug&&console.log("inst_c",s,r,t),"b"!=t&&(this.last_char=""),"S"!==t&&"T"!==t&&(this._rem_c="",this.wrap=!1),s){case"":switch(t){case"@":return this.ICH(r);case"E":return this.CNL(r);case"F":return this.CPL(r);case"G":return this.CHA(r);case"D":return this.CUB(r);case"B":return this.CUD(r);case"C":return this.CUF(r);case"A":return this.CUU(r);case"I":return this.CHT(r);case"Z":return this.CBT(r);case"f":case"H":return this.CUP(r);case"P":return this.DCH(r);case"J":return this.ED(r);case"K":return this.EL(r);case"L":return this.IL(r);case"M":return this.DL(r);case"S":return this.SU(r);case"T":return this.SD(r);case"X":return this.ECH(r);case"a":return this.HPR(r);case"b":return this.REP(r);case"e":return this.VPR(r);case"d":return this.VPA(r);case"c":return this.send(p.CSI+"?64;1;2;6;9;15;18;21;22c");case"h":return this.high(s,r);case"l":return this.low(s,r);case"m":return this.SGR(r);case"n":return this.DSR(s,r);case"r":return this.DECSTBM(r);case"s":return this.DECSC();case"u":return this.DECRC();case"`":return this.HPA(r);default:console.log("inst_c unhandled:",s,r,t)}break;case"?":switch(t){case"J":return this.ED(r);case"K":return this.EL(r);case"h":return this.high(s,r);case"l":return this.low(s,r);case"n":return this.DSR(s,r);default:console.log("inst_c unhandled:",s,r,t)}break;case">":switch(t){case"c":return this.send(p.CSI+">41;1;0c");default:console.log("inst_c unhandled:",s,r,t)}break;case"!":switch(t){case"p":return this.DECSTR();default:console.log("inst_c unhandled:",s,r,t)}break;default:console.log("inst_c unhandled:",s,r,t)}},n.prototype.inst_e=function(s,r){if(this.debug&&console.log("inst_e",s,r),this.last_char="",this._rem_c="",this.wrap=!1,s)if(" "==s)switch(r){default:console.log("inst_e unhandled:",s,r)}else if("#"==s)switch(r){case"8":return this.DECALN();default:console.log("inst_e unhandled:",s,r)}else if("%"==s)switch(r){default:this.charset=null}else if(-1!="()*+".indexOf(s))switch(r){case"0":this.charset=f;break;default:this.charset=null}else console.log("inst_e unhandled:",s,r);else switch(r){case"7":return this.DECSC();case"8":return this.DECRC();case"D":return this.IND();case"E":return this.NEL();case"M":return this.RI();case"c":return this.reset();default:console.log("inst_e unhandled:",s,r)}},n.prototype.inst_H=function(s,r,t){console.log("inst_H unhandled:",s,r,t),this.last_char="",this._rem_c="",this.wrap=!1},n.prototype.inst_P=function(s){console.log("inst_P unhandled:",s),this.last_char="",this._rem_c="",this.wrap=!1},n.prototype.inst_U=function(){console.log("inst_U unhandled"),this.last_char="",this._rem_c="",this.wrap=!1},n.prototype.DECALN=function(){this.scrolling_top=0,this.scrolling_bottom=this.rows;for(var r=0;r<this.screen.buffer.length;++r)for(var t=0;t<this.screen.buffer[r].cells.length;++t)this.screen.buffer[r].cells[t]=new s("E");this.CUP([0,0])},n.prototype.SD=function(r){var e=r?r[0]||1:1;do{var o=new t(this.cols,new s("",this.textattributes,this.colors));this.screen.buffer.splice(this.scrolling_top,0,o),this.screen.buffer.splice(this.scrolling_bottom,1)}while(--e)},n.prototype.SU=function(r){var e=r?r[0]||1:1;do{var o=new t(this.cols,new s("",this.textattributes,this.colors));this.screen.buffer.splice(this.scrolling_bottom,0,o);var i=this.screen.buffer.splice(this.scrolling_top,1)[0];this.scrolling_top||this.screen.appendToScrollBuffer(i)}while(--e)},n.prototype.REP=function(s){var r=s?s[0]||1:1;if(this.last_char){var t=this.wrap;this.cursor.col==this.cols-1&&(this.wrap=!0),this.inst_p(Array(r+1).join(this.last_char)),this.wrap=t,this.last_char=""}},n.prototype.NEL=function(){this.IND(),this.cursor.col=0},n.prototype.IND=function(){this.cursor.row++,this.cursor.row>=this.scrolling_bottom&&(this.SU(),this.cursor.row--)},n.prototype.VPR=function(s){this.cursor.row+=s[0]?s[0]:1,this.cursor.row>=this.rows&&(this.cursor.row=this.rows-1)},n.prototype.HPR=function(s){this.cursor.col+=s[0]?s[0]:1,this.cursor.col>=this.cols&&(this.cursor.col=this.cols-1)},n.prototype.HPA=function(s){this.cursor.col=(s[0]?s[0]:1)-1,this.cursor.col>=this.cols&&(this.cursor.col=this.cols-1)},n.prototype.CBT=function(s){this.cursor.col=(Math.floor((this.cursor.col-1)/this.tab_width)+1-(s[0]?s[0]:1))*this.tab_width,this.cursor.col<0&&(this.cursor.col=0)},n.prototype.CHT=function(s){this.cursor.col=(Math.floor(this.cursor.col/this.tab_width)+(s[0]?s[0]:1))*this.tab_width,this.cursor.col>=this.cols&&(this.cursor.col=this.cols-1)},n.prototype.CPL=function(s){this.cursor.row-=s[0]?s[0]:1,this.cursor.row<0&&(this.cursor.row=0),this.cursor.col=0},n.prototype.CNL=function(s){this.cursor.row+=s[0]?s[0]:1,this.cursor.row>=this.rows&&(this.cursor.row=this.rows-1),this.cursor.col=0},n.prototype.DL=function(r){var e=r[0]||1;do{this.screen.buffer.splice(this.cursor.row,1);var o=new t(this.cols,new s("",this.textattributes,this.colors));this.screen.buffer.splice(this.scrolling_bottom-1,0,o)}while(--e);this.cursor.col=0},n.prototype.ICH=function(r){var t=r[0]||1;do this.screen.buffer[this.cursor.row].cells.splice(this.cursor.col,0,new s("",this.textattributes,this.colors)),this.screen.buffer[this.cursor.row].cells.pop();while(--t)},n.prototype.VPA=function(s){this.cursor.row=(s[0]?s[0]:1)-1,this.cursor.row>=this.rows&&(this.cursor.row=this.rows-1)},n.prototype.ECH=function(r){var t=(r[0]?r[0]:1)+this.cursor.col;t=this.cols<t?this.cols:t;for(var e=this.cursor.col;t>e;++e)this.screen.buffer[this.cursor.row].cells[e]=new s("",this.textattributes,this.colors);this.screen.buffer[this.cursor.row].version++},n.prototype.IL=function(r){var e=r[0]?r[0]:1;do{var o=new t(this.cols,new s("",this.textattributes,this.colors));this.screen.buffer.splice(this.cursor.row,0,o),this.screen.buffer.splice(this.scrolling_bottom,1)}while(--e);this.cursor.col=0},n.prototype.DECSTBM=function(s){var r=s[0]-1||0,t=s[1]||this.rows;r=0>r?0:r>=this.rows?this.rows-1:r,t=t>this.rows?this.rows:t,t>r&&(this.scrolling_top=r,this.scrolling_bottom=t),this.cursor.row=0,this.cursor.col=0},n.prototype.DECSTR=function(){this.show_cursor=!0,this.insert_mode=!1,this.CUP(),this.cursor_key_mode=!1,this.DECSTBM([]),this.charset=null,this.SGR([0]),this.DECSC()},n.prototype.RI=function(){if(this.cursor.row-=1,this.cursor.row<this.scrolling_top){this.cursor.row=this.scrolling_top;var r=new t(this.cols,new s("",this.textattributes,this.colors));this.screen.buffer.splice(this.scrolling_top,0,r),this.screen.buffer.splice(this.scrolling_bottom,1)}},n.prototype.DECSC=function(){var s={};s.cursor={row:this.cursor.row,col:this.cursor.col},s.textattributes=this.textattributes,s.charattributes=this.charattributes,this.cursor_save=s},n.prototype.DECRC=function(){this.cursor_save?(this.cursor.col=this.cursor_save.cursor.col,this.cursor.row=this.cursor_save.cursor.row,this.textattributes=this.cursor_save.textattributes,this.charattributes=this.cursor_save.charattributes):(this.CUP(),this.ED([2]),this.textattributes=0,this.charattributes=0)},n.prototype.high=function(s,r){for(var t=0;t<r.length;++t)switch(r[t]){case 1:this.cursor_key_mode=!0;break;case 4:s?console.log("unhandled high",s,r[t]):this.insert_mode=!0;break;case 7:"?"==s?this.autowrap=!0:console.log("unhandled high",s,r[t]);break;case 12:"?"==s?this.blinking_cursor=!0:console.log("unhandled high",s,r[t]);break;case 20:s?console.log("unhandled high",s,r[t]):this.newline_mode=!0;break;case 25:this.show_cursor=!0;break;case 43:case 44:case 45:case 46:case 47:break;case 9:case 1e3:case 1001:case 1002:case 1003:this.mouse_mode=r[t],this.changedMouseHandling(this.mouse_mode,this.mouse_protocol);break;case 1005:case 1006:case 1015:this.mouse_protocol=r[t],this.changedMouseHandling(this.mouse_mode,this.mouse_protocol);break;case 1049:this.screen=this.alternate_screen,this.cursor=this.alternate_cursor;break;default:console.log("unhandled high",s,r[t])}},n.prototype.low=function(s,r){for(var t=0;t<r.length;++t)switch(r[t]){case 1:this.cursor_key_mode=!1;break;case 4:s?console.log("unhandled low",s,r[t]):this.insert_mode=!1;break;case 7:"?"==s?this.autowrap=!1:console.log("unhandled high",s,r[t]);break;case 12:"?"==s?this.blinking_cursor=!1:console.log("unhandled high",s,r[t]);break;case 20:s?console.log("unhandled high",s,r[t]):this.newline_mode=!1;break;case 25:this.show_cursor=!1;break;case 43:case 44:case 45:case 46:case 47:break;case 9:case 1e3:case 1001:case 1002:case 1003:this.mouse_mode=0,this.changedMouseHandling(this.mouse_mode,this.mouse_protocol);break;case 1005:case 1006:case 1015:this.mouse_protocol=0,this.changedMouseHandling(this.mouse_mode,this.mouse_protocol);break;case 1049:this.screen=this.normal_screen,this.cursor=this.normal_cursor;break;default:console.log("unhandled low",s,r[t])}},n.prototype.DSR=function(s,r){switch(r[0]){case 5:this.send(p.CSI+"0n");break;case 6:this.send(p.CSI+s+(this.cursor.row+1)+";"+(this.cursor.col+1)+"R");break;case 75:this.send(p.CSI+"?70n");break;default:console.log("unhandled DSR",s,r)}},n.prototype.CHA=function(s){this.cursor.col=(s?s[0]||1:1)-1,this.cursor.col>=this.cols&&(this.cursor.col=this.cols-1)},n.prototype.CUB=function(s){this.cursor.col-=s?s[0]||1:1,this.cursor.col<0&&(this.cursor.col=0)},n.prototype.CUD=function(s){this.cursor.row+=s?s[0]||1:1,this.cursor.row>=this.rows&&(this.cursor.row=this.rows-1)},n.prototype.CUF=function(s){this.cursor.col+=s?s[0]||1:1,this.cursor.col>=this.cols&&(this.cursor.col=this.cols-1)},n.prototype.CUU=function(s){this.cursor.row-=s?s[0]||1:1,this.cursor.row<0&&(this.cursor.row=0)},n.prototype.CUP=function(s){this.cursor.row=(s?s[0]||1:1)-1,this.cursor.row>=this.rows&&(this.cursor.row=this.rows-1),this.cursor.col=(s?s[1]||1:1)-1,this.cursor.col>=this.cols&&(this.cursor.col=this.cols-1)},n.prototype.DCH=function(r){for(var t=this.screen.buffer[this.cursor.row].cells.splice(this.cursor.col,r?r[0]||1:1),e=0;e<t.length;++e)this.screen.buffer[this.cursor.row].cells.push(new s("",this.textattributes,this.colors));this.screen.buffer[this.cursor.row].version++},n.prototype.ED=function(r){var e,o;switch(r?r[0]:0){case 0:for(this.EL([0]),e=this.cursor.row+1;e<this.rows;++e)o=new t(this.cols,new s("",this.textattributes,this.colors)),this.screen.buffer[e]=o;break;case 1:for(e=0;e<this.cursor.row;++e)o=new t(this.cols,new s("",this.textattributes,this.colors)),this.screen.buffer[e]=o;this.EL([1]);break;case 2:for(e=0;e<this.rows;++e)o=new t(this.cols,new s("",this.textattributes,this.colors)),this.screen.buffer[e]=o}},n.prototype.EL=function(r){var t;switch(r?r[0]:0){case 0:for(t=this.cursor.col;t<this.cols;++t)this.screen.buffer[this.cursor.row].cells[t]=new s("",this.textattributes,this.colors);this.screen.buffer[this.cursor.row].version++;break;case 1:for(t=0;t<=this.cursor.col;++t)this.screen.buffer[this.cursor.row].cells[t]=new s("",this.textattributes,this.colors);this.screen.buffer[this.cursor.row].version++;break;case 2:for(t=0;t<this.cols;++t)this.screen.buffer[this.cursor.row].cells[t]=new s("",this.textattributes,this.colors);this.screen.buffer[this.cursor.row].version++}},n.prototype.SGR=function(s){var r=this.textattributes,t=this.colors,e=0,o=!1,i=0;this.reverse_video&&(r|=1048576);for(var c=0;c<s.length;++c)if(e){if(!i){switch(s[c]){case 2:o=!0,i=3,r|=38==e?201326592:50331648;break;case 5:o=!1,i=1,r=38==e?-134217729&r|67108864:-33554433&r|16777216;break;default:console.log("sgr unknown extended color mode:",e[1]),e=0}continue}if(o)switch(i){case 3:r=38==e?-65281&r|s[c]<<8:-256&r|s[c];break;case 2:t=38==e?16777215&t|s[c]<<24:-16711681&t|s[c]<<16;break;case 1:t=38==e?-65281&t|s[c]<<8:-256&t|s[c]}else r=38==e?-65281&r|s[c]<<8:-256&r|s[c];i-=1,i||(e=0)}else switch(s[c]){case 0:r=0;break;case 1:r|=65536;break;case 2:break;case 3:r|=131072;break;case 4:r|=262144;break;case 5:r|=524288;break;case 6:r|=524288;break;case 7:r|=1048576;break;case 8:r|=2097152;break;case 9:break;case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:break;case 20:break;case 21:break;case 22:r&=-65537;break;case 23:r&=-131073;break;case 24:r&=-262145;break;case 25:r&=-524289;break;case 26:break;case 27:r&=-1048577;break;case 28:r&=-2097153;break;case 29:break;case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:r=-134283009&r|67108864|s[c]%10<<8;break;case 38:e=38;break;case 39:r&=-67108865;break;case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:r=-33554688&r|16777216|s[c]%10;break;case 48:e=48;break;case 49:r&=-16777217;break;case 90:case 91:case 92:case 93:case 94:case 95:case 96:case 97:r=-134283009&r|67108864|(s[c]%10|2048);break;case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:r=-33554688&r|16777216|s[c]%10|8;break;default:console.log("sgr unknown:",s[c])}this.charattributes=r,this.reverse_video=!!(1048576&r),r&=-1048577,this.textattributes=r,this.colors=t};var d={wcswidth:l,TChar:s,TRow:t,TScreen:h,AnsiTerminal:n};"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=d:"function"==typeof define&&define.amd?define([],function(){return d}):window.ansiterminal=d}();
